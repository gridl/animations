% convert -density 600 -delay 10 -loop 0 classic-batch.pdf classic-batch-pdf.gif
%   or
% convert -density 600 classic-batch.pdf classic-batch-%02d.png
% convert -delay 100 -loop 0 classic-batch*.png classic-batch.gif

\input{diagrams}

\def \FastRender{0}
\def \ShowWatermarks{0}
\def \StreamsTables{1}
\def \DiagramName{Fun}
\def \DebugStreamTable{0}
\def \DrawTriggerLineBottom{1}

\newcommand{\DrawOutputStream} {
	\DrawOutput{\stX}{\stX + \stW}{6 + \stInputY}{6.5 + \stInputY}{51}
}

\newcommand{\BatchDiagram}[3] {
\TriggersMulti{
	\def \stYoff{#1}

	\def \DebugStreamTable{0}
	\def \stX{0}
	\def \stW{10}
	\def \stY{2.5}
	\def \stH{5}
	\def \stYMinBase{5}
	\def \stYBoundBoost{0}
	\def \stYBoundBoostDown{0}
	\def \stYAxisLabel{1}
	\def \stLabel{INPUT}
	\StreamInline{
		\DrawInputsA[\stInputY]{c_datum_back}{c_datum_text}
	}

	\def \DebugStreamTable{0}
	\def \stX{0}
	\def \stW{10}
	\def \stY{2}
	\def \stH{0.5}
	\def \stYBoundBoost{0}
	\def \stLabel{SUM}
	\TableInline{
		\DrawInputsA[\stInputY + 0.5]{c_ghost}{c_ghost_text}
		#2
	}
	
	\def \DebugStreamTable{0}
	\def \stX{0}
	\def \stW{10}
	\def \stY{0}
	\def \stH{2}
	\def \stYMinBase{4}
	\def \stYBoundBoost{0.5}
	\def \stYBoundBoostDown{0}
	\def \stYAxisLabel{0}
	\def \stLabel{OUTPUT}
	\StreamInline{
		#3
	}
	
	\DrawXAxis{7.5}{1}
	\DrawXAxis{0}{0}
	\DrawDivider{2}
	\DrawDivider{2.5}
} 
}

\newcommand{\DrawTable}[2][\ostate] {
	\DrawState[#1]{\stX}{\stX + \stW}{\stY}{\stY + \stH}{#2}
}

\newcommand{\FrameA}[1] {
\BatchDiagram{#1}{
	\DrawTable[0]{}
}{}
}

\FrameA{0}
\if \FastRender 0
\FrameA{.111}
\FrameA{.222}
\fi

% +5
\newcommand{\FrameState}[2] {
\BatchDiagram{#1}{
	\DrawTable{#2}
}{
}
}

\if \FastRender 0
\FrameState{.333}{5}
\FrameState{.444}{5}
\FrameState{.555}{5}
\FrameState{0.666}{12}
\FrameState{0.777}{12}
\FrameState{0.888}{12}
\FrameState{1.000}{12}
\FrameState{1.111}{12}
\FrameState{1.222}{15}
\FrameState{1.333}{15}
\FrameState{1.444}{19}
\FrameState{1.555}{19}
\FrameState{1.666}{22}
\FrameState{1.777}{22}
\FrameState{1.888}{22}
\FrameState{2.000}{22}
\FrameState{2.111}{30}
\FrameState{2.222}{30}
\FrameState{2.333}{33}
\FrameState{2.444}{33}
\fi % \FastRender
\FrameState{2.555}{33}
\if \FastRender 0
\FrameState{2.666}{33}
\FrameState{2.777}{33}
\FrameState{2.888}{33}
\FrameState{3.000}{33}
\FrameState{3.111}{33}
\FrameState{3.222}{33}
\FrameState{3.333}{42}
\FrameState{3.444}{42}
\FrameState{3.555}{42}
\FrameState{3.666}{50}
\fi % \FastRender
\FrameState{3.777}{50}
\newcommand{\FrameOutput}[2] {
\BatchDiagram{#1}{
	\DrawTable{#2}
}{
	\DrawOutputStream
}
}
\if \FastRender 0
\FrameState{3.888}{50}
\FrameOutput{4.000}{51}
\fi % \FastRender
\FrameOutput{4.111}{51}
\if \FastRender 0
\FrameOutput{4.222}{51}
\FrameOutput{4.333}{51}
\FrameOutput{4.444}{51}
\FrameOutput{4.555}{51}
\FrameOutput{4.666}{51}
\FrameOutput{4.777}{51}
\FrameOutput{4.888}{51}
\FrameOutput{5.000}{51}
\FrameOutput{5.111}{51}
\FrameOutput{5.222}{51}
\FrameOutput{5.333}{51}
\FrameOutput{5.444}{51}
\FrameOutput{5.555}{51}
\FrameOutput{5.666}{51}
\FrameOutput{5.777}{51}
\FrameOutput{5.888}{51}
\FrameOutput{6.000}{51}
\FrameOutput{6.111}{51}
\FrameOutput{6.222}{51}
\FrameOutput{6.333}{51}
\FrameOutput{6.444}{51}
\FrameOutput{6.555}{51}
\FrameOutput{6.666}{51}
\FrameOutput{6.777}{51}
\FrameOutput{6.888}{51}

\fi % \FastRender

\FrameOutput{7.000}{51}


\end{document}
